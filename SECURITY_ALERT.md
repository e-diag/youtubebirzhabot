# üö® –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï –û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

## –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ SQL Injection –∞—Ç–∞–∫–∏

–í –ª–æ–≥–∞—Ö PostgreSQL –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ–ø—ã—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ SQL –∫–æ–¥–∞ —á–µ—Ä–µ–∑ —Ñ—É–Ω–∫—Ü–∏—é `COPY FROM PROGRAM`.

### –ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:

–ê—Ç–∞–∫—É—é—â–∏–π –ø—ã—Ç–∞–ª—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
```sql
COPY tests FROM PROGRAM 'echo [base64 encoded malicious script]|base64 -d|bash'
```

–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –ø—ã—Ç–∞–ª—Å—è:
1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ `195.24.237.73`
2. –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã Docker, Redis, dash
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å backdoor –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### ‚úÖ –•–æ—Ä–æ—à–∏–µ –Ω–æ–≤–æ—Å—Ç–∏:

1. **–ê—Ç–∞–∫–∞ –±—ã–ª–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞** - PostgreSQL —É–±–∏–ª –ø—Ä–æ—Ü–µ—Å—Å (signal 9: Killed)
2. **–ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–µ–Ω** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GORM —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
3. **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î –∏–∑–≤–Ω–µ** - –ø–æ—Ä—Ç 5432 –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç –ø—É–±–ª–∏—á–Ω–æ

### ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –°–†–û–ß–ù–û:

#### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ –±—ã–ª –ª–∏ —Å–µ—Ä–≤–µ—Ä —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep -E "docker|redis|dash|bot"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
netstat -tulpn | grep -E "195.24.237.73"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã –≤ /tmp
ls -la /tmp/bot* /tmp/*.sh 2>/dev/null

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ PostgreSQL –Ω–∞ –¥—Ä—É–≥–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
docker compose logs postgres | grep -iE "COPY|PROGRAM|EXECUTE|FROM PROGRAM"
```

#### 2. –û—Ç–∫–ª—é—á–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –≤ PostgreSQL:

–£–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ `docker-compose.yml`:
- `shared_preload_libraries=''` - –æ—Ç–∫–ª—é—á–∞–µ—Ç –æ–ø–∞—Å–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- `allow_system_table_mods=off` - –∑–∞–ø—Ä–µ—â–∞–µ—Ç –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- `log_statement=all` - –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã

#### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ë–î:

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 5432 –ù–ï –æ—Ç–∫—Ä—ã—Ç –ø—É–±–ª–∏—á–Ω–æ
sudo netstat -tulpn | grep 5432
# –ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ 0.0.0.0:5432 - —ç—Ç–æ –ø–ª–æ—Ö–æ! –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ç–æ–ª—å–∫–æ 127.0.0.1:5432 –∏–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ –≤–∏–¥–Ω–æ

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall
sudo ufw status
# –∏–ª–∏
sudo iptables -L -n | grep 5432
```

#### 4. –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏:

```bash
# –°–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å PostgreSQL
# –í .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
POSTGRES_PASSWORD=–Ω–æ–≤—ã–π_—Å–∏–ª—å–Ω—ã–π_–ø–∞—Ä–æ–ª—å_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose down
docker compose up -d
```

#### 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–µ—Ç –ª–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
docker compose logs app | grep -iE "error|sql|query|COPY|PROGRAM"
```

### üîí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

1. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ PostgreSQL:**
   - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 5432 –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∏–∑ Docker —Å–µ—Ç–∏
   - –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –ø–æ—Ä—Ç 5432 –≤ firewall

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏:**
   - –ú–∏–Ω–∏–º—É–º 32 —Å–∏–º–≤–æ–ª–∞
   - –°–ª—É—á–∞–π–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã, —Ü–∏—Ñ—Ä—ã, –±—É–∫–≤—ã

3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ:**
   - Docker –æ–±—Ä–∞–∑—ã
   - PostgreSQL
   - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏

### üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞:

‚úÖ **–ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–µ–Ω:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GORM —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ (`Where("field = ?", value)`)
- –ù–µ—Ç –ø—Ä—è–º–æ–≥–æ SQL —á–µ—Ä–µ–∑ `fmt.Sprintf` –∏–ª–∏ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—é —Å—Ç—Ä–æ–∫
- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è

### üö® –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –±—ã–ª —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω:

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –æ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**
2. **–°–æ–∑–¥–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ, –Ω–µ –∫–æ–¥!)**
3. **–ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Å –Ω—É–ª—è**
4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏**
5. **–°–º–µ–Ω–∏—Ç–µ –≤—Å–µ –ø–∞—Ä–æ–ª–∏ –∏ –∫–ª—é—á–∏**

---

**–í–ê–ñ–ù–û:** –≠—Ç–∞ –∞—Ç–∞–∫–∞ –±—ã–ª–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ PostgreSQL (–ø—Ä–æ—Ü–µ—Å—Å –±—ã–ª —É–±–∏—Ç), –Ω–æ –Ω—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –Ω–µ –±—ã–ª —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω —Ä–∞–Ω–µ–µ —á–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏.
